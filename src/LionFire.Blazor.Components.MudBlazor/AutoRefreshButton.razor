@inject ILogger<AutoRefreshButton> Logger
@implements IDisposable
@namespace LionFire.Blazor.Components.MudBlazor_

@*TODO: tooltip to show error *@
@*TODO: contextmenu to select refresh interval *@
@*TODO: different icon if can't enable? or perma error *@
@*TODO: more informative tooltip to say "Refreshing for 1s" or "Refreshing in 15s" *@
@*TODO: use CSS for coloring instead of MudBlazor color palette *@
@*TODO: set default logging levels to Information? *@

<button class=@($"refresh toggle {(Auto ? "toggled" : "untoggled")} {(Refreshing ? "busy" : "")} {(Errored ? "errored" : "")}") oncontextmenu=@OnContextMenu onclick=@OnToggleRefresh
 style=@(Auto ? $"background-image: url(\"data:image/svg+xml,%3csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3e%3crect width='100%25' height='100%25' fill='none' stroke='%2399b' stroke-width='1' stroke-dasharray='3%2c 3' stroke-dashoffset='{-Count}' stroke-linecap='square'/%3e%3c/svg%3e\");" : "")

title=@Tooltip
>
    @if (Refreshing)
    {
        <MudIcon Icon=@Icons.Filled.Refresh Style=@($"color: {Colors.LightGreen.Default};") />
    }
    else if (Errored)
    {
        <MudIcon Icon=@Icons.Filled.Refresh Style=@($"color: {Colors.Red.Darken1};") />
    }
    else if (Auto)
    {
        <MudIcon Icon=@Icons.Filled.Refresh Style=@($"color: {Colors.Blue.Default};") />
    }
    else if (CanRefresh)
    {
        <MudIcon Icon=@Icons.Filled.Refresh Style=@($"color: {Colors.Grey.Darken2};") />
    }
    else
    {
        <MudIcon Icon=@Icons.Filled.Refresh Style=@($"color: {Colors.Grey.Darken4};") />
    }
</button>
