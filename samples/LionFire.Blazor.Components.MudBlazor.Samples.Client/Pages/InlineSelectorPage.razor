@page "/inline-selector"

<PageTitle>InlineSelector Component</PageTitle>

<MudText Typo="Typo.h3" GutterBottom="true">InlineSelector Component Examples</MudText>

<MudText Class="mb-4">
    The InlineSelector component provides a flexible way to display selectable items inline with support for favorites,
    dropdown view, item creation, and multiple size options.
</MudText>

<MudPaper Class="pa-4 mb-4">
    <MudText Typo="Typo.h5" GutterBottom="true">Example 1: Simple Usage with String Items</MudText>
    <MudText Typo="Typo.body2" Class="mb-2">Basic inline selector with string values:</MudText>

    <div class="mb-4">
        <InlineSelector TItem="string"
                        Items="@workspaceNames"
                        SelectedItem="@selectedWorkspace"
                        SelectedItemChanged="@OnWorkspaceChanged" />
    </div>

    <MudAlert Severity="Severity.Info" Dense="true">
        Selected: <strong>@selectedWorkspace</strong>
    </MudAlert>
</MudPaper>

<MudPaper Class="pa-4 mb-4">
    <MudText Typo="Typo.h5" GutterBottom="true">Example 2: With Favorites and Dropdown</MudText>
    <MudText Typo="Typo.body2" Class="mb-2">
        Only favorite items shown inline. Hover to see dropdown with all items and toggle favorites.
        Click the + button to create new items.
    </MudText>

    <div class="mb-4">
        <InlineSelector TItem="WorkspaceInfo"
                        Items="@workspaces"
                        SelectedItem="@selectedWorkspaceInfo"
                        SelectedItemChanged="@OnWorkspaceInfoChanged"
                        ItemTemplate="@workspaceTemplate"
                        ItemTextFunc="@((w) => w.Name)"
                        FavoriteFunc="@((w) => w.IsFavorite)"
                        SetFavoriteFunc="@ToggleFavorite"
                        ShowDropdown="true"
                        CreateFunc="@CreateNewWorkspace" />
    </div>

    <MudAlert Severity="Severity.Info" Dense="true">
        Selected: <strong>@(selectedWorkspaceInfo?.Name ?? "None")</strong>
    </MudAlert>
</MudPaper>

<MudPaper Class="pa-4 mb-4">
    <MudText Typo="Typo.h5" GutterBottom="true">Example 3: Size Variations</MudText>
    <MudText Typo="Typo.body2" Class="mb-2">Different size options for various use cases:</MudText>

    <MudStack Spacing="4">
        <div>
            <MudText Typo="Typo.subtitle2" Class="mb-2">Large Size:</MudText>
            <InlineSelector TItem="string"
                            Items="@workspaceNames"
                            SelectedItem="@selectedWorkspace"
                            SelectedItemChanged="@OnWorkspaceChanged"
                            Size="InlineSelectorSize.Large" />
        </div>

        <div>
            <MudText Typo="Typo.subtitle2" Class="mb-2">Medium Size (Default):</MudText>
            <InlineSelector TItem="string"
                            Items="@workspaceNames"
                            SelectedItem="@selectedWorkspace"
                            SelectedItemChanged="@OnWorkspaceChanged"
                            Size="InlineSelectorSize.Medium" />
        </div>

        <div>
            <MudText Typo="Typo.subtitle2" Class="mb-2">Small Size:</MudText>
            <InlineSelector TItem="string"
                            Items="@workspaceNames"
                            SelectedItem="@selectedWorkspace"
                            SelectedItemChanged="@OnWorkspaceChanged"
                            Size="InlineSelectorSize.Small" />
        </div>

        <div>
            <MudText Typo="Typo.subtitle2" Class="mb-2">Compact Size:</MudText>
            <InlineSelector TItem="string"
                            Items="@workspaceNames"
                            SelectedItem="@selectedWorkspace"
                            SelectedItemChanged="@OnWorkspaceChanged"
                            Size="InlineSelectorSize.Compact" />
        </div>

        <div>
            <MudText Typo="Typo.subtitle2" Class="mb-2">Abbreviated (3 chars):</MudText>
            <InlineSelector TItem="string"
                            Items="@workspaceNames"
                            SelectedItem="@selectedWorkspace"
                            SelectedItemChanged="@OnWorkspaceChanged"
                            Size="InlineSelectorSize.Abbreviated"
                            AbbreviatedMaxLength="3" />
        </div>

        <div>
            <MudText Typo="Typo.subtitle2" Class="mb-2">Single Letter:</MudText>
            <InlineSelector TItem="string"
                            Items="@workspaceNames"
                            SelectedItem="@selectedWorkspace"
                            SelectedItemChanged="@OnWorkspaceChanged"
                            Size="InlineSelectorSize.SingleLetter" />
        </div>

        <div>
            <MudText Typo="Typo.subtitle2" Class="mb-2">Square (Colored boxes):</MudText>
            <InlineSelector TItem="string"
                            Items="@workspaceNames"
                            SelectedItem="@selectedWorkspace"
                            SelectedItemChanged="@OnWorkspaceChanged"
                            Size="InlineSelectorSize.Square" />
        </div>
    </MudStack>
</MudPaper>

<MudPaper Class="pa-4 mb-4">
    <MudText Typo="Typo.h5" GutterBottom="true">Example 4: Custom Colors</MudText>
    <MudText Typo="Typo.body2" Class="mb-2">Custom colors per item with square size:</MudText>

    <div class="mb-4">
        <InlineSelector TItem="ColoredWorkspace"
                        Items="@coloredWorkspaces"
                        SelectedItem="@selectedColoredWorkspace"
                        SelectedItemChanged="@OnColoredWorkspaceChanged"
                        ItemTemplate="@coloredWorkspaceTemplate"
                        ItemTextFunc="@((w) => w.Name)"
                        ItemColorSource="@((w) => w.Color)"
                        Size="InlineSelectorSize.Square" />
    </div>

    <MudAlert Severity="Severity.Info" Dense="true">
        Selected: <strong>@(selectedColoredWorkspace?.Name ?? "None")</strong>
    </MudAlert>
</MudPaper>

<MudPaper Class="pa-4 mb-4">
    <MudText Typo="Typo.h5" GutterBottom="true">Example 5: Custom Styling</MudText>
    <MudText Typo="Typo.body2" Class="mb-2">With custom container styling and selected item color:</MudText>

    <div class="mb-4">
        <InlineSelector TItem="string"
                        Items="@workspaceNames"
                        SelectedItem="@selectedWorkspace"
                        SelectedItemChanged="@OnWorkspaceChanged"
                        SelectedItemColor="Color.Success"
                        ContainerStyle="background-color: rgba(0,0,0,0.05); padding: 12px; border-radius: 8px;" />
    </div>
</MudPaper>

<MudPaper Class="pa-4 mb-4">
    <MudText Typo="Typo.h5" GutterBottom="true">Example 6: Max Rows</MudText>
    <MudText Typo="Typo.body2" Class="mb-2">Limit items to a maximum number of rows with scrollable overflow:</MudText>

    <MudStack Spacing="4">
        <div>
            <MudText Typo="Typo.subtitle2" Class="mb-2">MaxRows = 2:</MudText>
            <InlineSelector TItem="string"
                            Items="@manyWorkspaces"
                            SelectedItem="@selectedManyWorkspace"
                            SelectedItemChanged="@OnManyWorkspaceChanged"
                            MaxRows="2" />
        </div>

        <div>
            <MudText Typo="Typo.subtitle2" Class="mb-2">MaxRows = 3 with Small Size:</MudText>
            <InlineSelector TItem="string"
                            Items="@manyWorkspaces"
                            SelectedItem="@selectedManyWorkspace"
                            SelectedItemChanged="@OnManyWorkspaceChanged"
                            Size="InlineSelectorSize.Small"
                            MaxRows="3" />
        </div>

        <div>
            <MudText Typo="Typo.subtitle2" Class="mb-2">No MaxRows (default - wraps naturally):</MudText>
            <InlineSelector TItem="string"
                            Items="@manyWorkspaces"
                            SelectedItem="@selectedManyWorkspace"
                            SelectedItemChanged="@OnManyWorkspaceChanged" />
        </div>
    </MudStack>
</MudPaper>

<MudPaper Class="pa-4">
    <MudText Typo="Typo.h6" GutterBottom="true">Features</MudText>
    <MudList T="string" Dense="true">
        <MudListItem T="string" Icon="@Icons.Material.Filled.Check">7 different size options from large to colored squares</MudListItem>
        <MudListItem T="string" Icon="@Icons.Material.Filled.Check">Inline display with filled style for selected item</MudListItem>
        <MudListItem T="string" Icon="@Icons.Material.Filled.Check">Action buttons positioned on the right (stacked vertically)</MudListItem>
        <MudListItem T="string" Icon="@Icons.Material.Filled.Check">Optional favorites filtering</MudListItem>
        <MudListItem T="string" Icon="@Icons.Material.Filled.Check">Optional dropdown to view all items</MudListItem>
        <MudListItem T="string" Icon="@Icons.Material.Filled.Check">Optional creation button</MudListItem>
        <MudListItem T="string" Icon="@Icons.Material.Filled.Check">Custom colors with automatic rotation</MudListItem>
        <MudListItem T="string" Icon="@Icons.Material.Filled.Check">Custom item templates</MudListItem>
        <MudListItem T="string" Icon="@Icons.Material.Filled.Check">MaxRows parameter to limit vertical space with scrolling</MudListItem>
    </MudList>
</MudPaper>

@code {
    // Example 1: Simple string-based workspaces
    private List<string> workspaceNames = new() { "Development", "Staging", "Production" };
    private string selectedWorkspace = "Development";

    // Example 6: Many workspaces for MaxRows demo
    private List<string> manyWorkspaces = new()
    {
        "Development", "Staging", "Production", "Testing", "QA",
        "UAT", "Demo", "Preview", "Integration", "Performance",
        "Sandbox", "Training", "Backup", "Archive"
    };
    private string selectedManyWorkspace = "Development";

    private async Task OnWorkspaceChanged(string workspace)
    {
        selectedWorkspace = workspace;
        await Task.CompletedTask;
    }

    // Example 2: Complex workspace objects with favorites
    public class WorkspaceInfo
    {
        public string Id { get; set; } = string.Empty;
        public string Name { get; set; } = string.Empty;
        public bool IsFavorite { get; set; }
    }

    private List<WorkspaceInfo> workspaces = new()
    {
        new() { Id = "dev", Name = "Development", IsFavorite = true },
        new() { Id = "staging", Name = "Staging", IsFavorite = true },
        new() { Id = "prod", Name = "Production", IsFavorite = false },
        new() { Id = "test", Name = "Testing", IsFavorite = false },
    };

    private WorkspaceInfo? selectedWorkspaceInfo;

    private RenderFragment<WorkspaceInfo> workspaceTemplate = (workspace) => __builder =>
    {
        <MudText Typo="Typo.button">@workspace.Name</MudText>
    };

    protected override void OnInitialized()
    {
        selectedWorkspaceInfo = workspaces.FirstOrDefault(w => w.IsFavorite);
        selectedColoredWorkspace = coloredWorkspaces.FirstOrDefault();
    }

    private async Task OnWorkspaceInfoChanged(WorkspaceInfo workspace)
    {
        selectedWorkspaceInfo = workspace;
        await Task.CompletedTask;
    }

    private async Task ToggleFavorite(WorkspaceInfo workspace)
    {
        workspace.IsFavorite = !workspace.IsFavorite;
        await Task.CompletedTask;
    }

    private async Task CreateNewWorkspace()
    {
        var newId = $"workspace{workspaces.Count + 1}";
        var newWorkspace = new WorkspaceInfo
        {
            Id = newId,
            Name = $"Workspace {workspaces.Count + 1}",
            IsFavorite = false
        };
        workspaces.Add(newWorkspace);
        await Task.CompletedTask;
    }

    // Example 4: Colored workspaces
    public class ColoredWorkspace
    {
        public string Name { get; set; } = string.Empty;
        public MudBlazor.Color Color { get; set; }
    }

    private List<ColoredWorkspace> coloredWorkspaces = new()
    {
        new() { Name = "Primary", Color = Color.Primary },
        new() { Name = "Secondary", Color = Color.Secondary },
        new() { Name = "Success", Color = Color.Success },
        new() { Name = "Warning", Color = Color.Warning },
        new() { Name = "Error", Color = Color.Error },
        new() { Name = "Info", Color = Color.Info },
    };

    private ColoredWorkspace? selectedColoredWorkspace;

    private RenderFragment<ColoredWorkspace> coloredWorkspaceTemplate = (workspace) => __builder =>
    {
        <span>@workspace.Name</span>
    };

    private async Task OnColoredWorkspaceChanged(ColoredWorkspace workspace)
    {
        selectedColoredWorkspace = workspace;
        await Task.CompletedTask;
    }

    private async Task OnManyWorkspaceChanged(string workspace)
    {
        selectedManyWorkspace = workspace;
        await Task.CompletedTask;
    }
}
